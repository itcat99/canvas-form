!function(t){var e={};function i(r){if(e[r])return e[r].exports;var s=e[r]={i:r,l:!1,exports:{}};return t[r].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=t,i.c=e,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)i.d(r,s,function(e){return t[e]}.bind(null,s));return r},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/",i(i.s=13)}([function(t,e,i){var r=i(7),s=i(8),n=i(9);t.exports=function(t,e){return r(t)||s(t,e)||n()}},function(t,e){t.exports=function(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}},function(t,e,i){var r=i(10),s=i(11),n=i(12);t.exports=function(t){return r(t)||s(t)||n()}},function(t,e){function i(){return t.exports=i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t},i.apply(this,arguments)}t.exports=i},function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e){function i(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}t.exports=function(t,e,r){return e&&i(t.prototype,e),r&&i(t,r),t}},function(t,e,i){var r,s,n;s=[e],void 0===(n="function"==typeof(r=function(t){"use strict";function e(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890";!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var s,n,o="";this.escapeRegExp=function(t){return t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},this.parseInt=function(t,e){return/^(-|\+)?([0-9]+|Infinity)$/.test(t)?parseInt(t,e):NaN},this.seps="cfhistuCFHISTU",this.minLength=0<parseInt(i,10)?i:0,this.salt="string"==typeof e?e:"","string"==typeof r&&(this.alphabet=r);for(var l=0;l!==this.alphabet.length;l++)-1===o.indexOf(this.alphabet.charAt(l))&&(o+=this.alphabet.charAt(l));if(this.alphabet=o,this.alphabet.length<16)throw"error: alphabet must contain at least X unique characters".replace("X",16);if(-1!==this.alphabet.search(" "))throw"error: alphabet cannot contain spaces";for(var h=0;h!==this.seps.length;h++){var a=this.alphabet.indexOf(this.seps.charAt(h));-1===a?this.seps=this.seps.substr(0,h)+" "+this.seps.substr(h+1):this.alphabet=this.alphabet.substr(0,a)+" "+this.alphabet.substr(a+1)}this.alphabet=this.alphabet.replace(/ /g,""),this.seps=this.seps.replace(/ /g,""),this.seps=this._shuffle(this.seps,this.salt),(!this.seps.length||3.5<this.alphabet.length/this.seps.length)&&(s=Math.ceil(this.alphabet.length/3.5))>this.seps.length&&(n=s-this.seps.length,this.seps+=this.alphabet.substr(0,n),this.alphabet=this.alphabet.substr(n)),this.alphabet=this._shuffle(this.alphabet,this.salt);var c=Math.ceil(this.alphabet.length/12);this.alphabet.length<3?(this.guards=this.seps.substr(0,c),this.seps=this.seps.substr(c)):(this.guards=this.alphabet.substr(0,c),this.alphabet=this.alphabet.substr(c))}var i,r;return i=t,(r=[{key:"encode",value:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];if(!e.length)return"";if(e[0]&&e[0].constructor===Array&&!(e=e[0]).length)return"";for(var r=0;r!==e.length;r++)if(e[r]=this.parseInt(e[r],10),!(0<=e[r]))return"";return this._encode(e)}},{key:"decode",value:function(t){return t&&t.length&&"string"==typeof t?this._decode(t,this.alphabet):[]}},{key:"encodeHex",value:function(t){if(t=t.toString(),!/^[0-9a-fA-F]+$/.test(t))return"";for(var e=t.match(/[\w\W]{1,12}/g),i=0;i!==e.length;i++)e[i]=parseInt("1"+e[i],16);return this.encode.apply(this,e)}},{key:"decodeHex",value:function(t){for(var e=[],i=this.decode(t),r=0;r!==i.length;r++)e+=i[r].toString(16).substr(1);return e}},{key:"_encode",value:function(t){for(var e,i=this.alphabet,r=0,s=0;s!==t.length;s++)r+=t[s]%(s+100);for(var n=e=i.charAt(r%i.length),o=0;o!==t.length;o++){var l=t[o],h=n+this.salt+i;i=this._shuffle(i,h.substr(0,i.length));var a=this._toAlphabet(l,i);if(e+=a,o+1<t.length){var c=(l%=a.charCodeAt(0)+o)%this.seps.length;e+=this.seps.charAt(c)}}if(e.length<this.minLength){var f=(r+e[0].charCodeAt(0))%this.guards.length,u=this.guards[f];(e=u+e).length<this.minLength&&(f=(r+e[2].charCodeAt(0))%this.guards.length,e+=u=this.guards[f])}for(var d=parseInt(i.length/2,10);e.length<this.minLength;){var v=(e=(i=this._shuffle(i,i)).substr(d)+e+i.substr(0,d)).length-this.minLength;0<v&&(e=e.substr(v/2,this.minLength))}return e}},{key:"_decode",value:function(t,e){var i=[],r=0,s=new RegExp("[".concat(this.escapeRegExp(this.guards),"]"),"g"),n=t.replace(s," "),o=n.split(" ");if(3!==o.length&&2!==o.length||(r=1),void 0!==(n=o[r])[0]){var l=n[0];n=n.substr(1),s=new RegExp("[".concat(this.escapeRegExp(this.seps),"]"),"g"),o=(n=n.replace(s," ")).split(" ");for(var h=0;h!==o.length;h++){var a=o[h],c=l+this.salt+e;e=this._shuffle(e,c.substr(0,e.length)),i.push(this._fromAlphabet(a,e))}this.encode(i)!==t&&(i=[])}return i}},{key:"_shuffle",value:function(t,e){var i;if(!e.length)return t;for(var r=(t=t.split("")).length-1,s=0,n=0,o=0;0<r;r--,s++){s%=e.length,n+=i=e.charCodeAt(s);var l=t[o=(i+s+n)%r];t[o]=t[r],t[r]=l}return t=t.join("")}},{key:"_toAlphabet",value:function(t,e){for(var i="";i=e.charAt(t%e.length)+i,t=parseInt(t/e.length,10););return i}},{key:"_fromAlphabet",value:function(t,e){return t.split("").map(function(t){return e.indexOf(t)}).reduce(function(t,i){return t*e.length+i},0)}}])&&e(i.prototype,r),t}();t.default=i})?r.apply(e,s):r)||(t.exports=n)},function(t,e){t.exports=function(t){if(Array.isArray(t))return t}},function(t,e){t.exports=function(t,e){var i=[],r=!0,s=!1,n=void 0;try{for(var o,l=t[Symbol.iterator]();!(r=(o=l.next()).done)&&(i.push(o.value),!e||i.length!==e);r=!0);}catch(t){s=!0,n=t}finally{try{r||null==l.return||l.return()}finally{if(s)throw n}}return i}},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}},function(t,e){t.exports=function(t){if(Array.isArray(t)){for(var e=0,i=new Array(t.length);e<t.length;e++)i[e]=t[e];return i}}},function(t,e){t.exports=function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}},function(t,e,i){"use strict";i.r(e);var r={};i.r(r),i.d(r,"getRows",function(){return M}),i.d(r,"getCols",function(){return W}),i.d(r,"getRow",function(){return T}),i.d(r,"getCol",function(){return A}),i.d(r,"getSelectedCell",function(){return H});var s=i(0),n=i.n(s),o=i(2),l=i.n(o),h=i(3),a=i.n(h),c=i(4),f=i.n(c),u=i(5),d=i.n(u),v=i(1),p=i.n(v),g={className:"canvas-form",target:"#root",width:1200,height:600,fillColor:"#000",strokeColor:"#000",fontSize:14,fontWeight:400,fontFamily:"sans-serif",horizontalAlign:"center",verticalAlign:"center",autoSize:!1,columns:[],rows:[],merges:[],renderColCount:12,renderRowCount:25,columnWidth:100,rowHeight:30,scrollYSize:15,scrollXSize:15,scroll:!1,bitWidth:10,setRowStyle:null,setColStyle:null,setCellStyle:null},y=(i(6),function(t){return Math.round(t)});function w(t,e,i){var r=t.filter(function(t){var r=i?t[i]:t;if(e-r>=0)return e-r});return r.sort(function(t,r){return(i?e-t[i]:e-t)-(i?e-r[i]:e-r)}),r[0]}var x=function(t,e,i){var r=e.x,s=e.y,n=e.width,o=e.height;return{value:t,x:y(r+n/2),y:y(s+o/2)}},m="undefined"!=typeof navigator&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),S=function(t,e,i){for(var r="",s=Math.floor(e/t.length),n=(t+"").split(""),o=0;o<n.length;o++){var l=n[o];if((o+1)*s>=i-5)break;r+=l}return r},b=function(t,e,i){var r=n()(t,2),s=r[0],o=r[1],l=e.from,h=e.to,a=n()(l,2),c=a[0],f=a[1],u=n()(h,2),d=u[0],v=u[1];return i?s>=c&&s<=d&&o>=f&&o<=v:s>c&&s<d&&o>f&&o<v},C={13:"ENTER",40:"ARROW_DOWN",37:"ARROW_LEFT",39:"ARROW_RIGHT",38:"ARROW_UP"},R=function(t){var e=t.lines,i=t.ctx,r=t.styles;if(!e||!e.length)return!1;r&&(i.save(),E(r,i)),i.beginPath(),e.forEach(function(t){if(!t)return!1;var e=t.from,r=t.to;i.moveTo(e[0],e[1]),i.lineTo(r[0],r[1]),i.stroke()}),i.stroke(),i.closePath(),r&&i.restore()},O=function(t,e){t.forEach(function(t){if(!t)return!1;var i=t.value,r=t.x,s=t.y;e.fillText(i,r,s)})},k=function(t,e){if(!t||!t.length)return!1;t.forEach(function(t){if(!t)return!1;var i=t.x,r=t.y,s=t.width,n=void 0===s?e.width:s,o=t.height,l=void 0===o?e.height:o;e.clearRect(i,r,n,l)})},E=function(t,e){for(var i in t)e[i]=t[i]},X=function(t,e,i){i?(e.save(),Array.isArray(i)?t.forEach(function(t,r){E(i[r],e),e.fillRect.apply(e,l()(t))}):(E(i,e),t.forEach(function(t){e.fillRect.apply(e,l()(t))})),e.restore()):t.forEach(function(t){e.fillRect.apply(e,l()(t))})},I=function(){function t(e){var i=this;f()(this,t),p()(this,"onMouseIn",function(t){var e=t.type,r=t.offset;e===i.type&&(i.isInBar(r)&&(document.body.style.cursor="pointer",i.updateBarStyle({fillStyle:"rgba(0,0,0,.5)"})),i.mouseIn=!0)}),p()(this,"onMouseOut",function(){i.mouseIn&&(document.body.style.cursor="default",i.mouseIn=!1,i.updateBarStyle({fillStyle:"rgba(0,0,0,.2)"}))}),p()(this,"onScrolling",function(){}),this.opts=e;var r=e.emitter,s=e.ctx,n=e.type,o=e.width,l=e.height,h=e.barWidth,a=e.barHeight,c=e.maxScrollSize,u=e.offset,d=void 0===u?0:u;this.emitter=r,this.ctx=s,this.type=n,this.offset=d,this.width=o,this.height=l,this.barWidth=h,this.barHeight=a,this.maxScrollSize=c,this.mouseIn=!1,this.init(),this.listen()}return d()(t,[{key:"init",value:function(){this.scrollTo(this.offset)}},{key:"scrollTo",value:function(t){this.offset=t;var e=this.opts,i=[e.x,e.y,this.width,this.height],r=this.getBarInfo();X([i,r],this.ctx,[{fillStyle:"#ffffff"},{fillStyle:"rgba(0,0,0,.2)"}])}},{key:"getBarInfo",value:function(){var t=this.opts,e=t.x,i=t.y,r=e,s=this.offset+i;return"x"===this.type&&(r=this.offset+e,s=i),[r,s,this.barWidth,this.barHeight]}},{key:"updateBarStyle",value:function(t){var e=this.getBarInfo();X([e],this.ctx,{fillStyle:"#fff"}),X([e],this.ctx,t)}},{key:"listen",value:function(){this.emitter.on("SCROLLER_HOVER",this.onMouseIn),this.emitter.on("SCROLLER_HOVER_OFF",this.onMouseOut),this.emitter.on("SCROLLING",this.onScrolling)}},{key:"isInBar",value:function(t){var e=this.getBarInfo(),i=n()(e,4),r=i[0],s=i[1],o=i[2],l=i[3];return b(t,{from:[r,s],to:[r+o,s+l]})}},{key:"updateBar",value:function(){}}]),t}();var L=function(t){return t=t||Object.create(null),{on:function(e,i){(t[e]||(t[e]=[])).push(i)},off:function(e,i){t[e]&&t[e].splice(t[e].indexOf(i)>>>0,1)},emit:function(e,i){(t[e]||[]).slice().map(function(t){t(i)}),(t["*"]||[]).slice().map(function(t){t(e,i)})}}},Y=function(){function t(e){var i=this;f()(this,t),p()(this,"onClick",function(t){var e=y(t.offsetX),r=y(t.offsetY);if(i.hoverScrollerY||i.hoverScrollerX)return console.log("click scroller"),!1;var s=i.selectedCell;i.updateSelect(i.realSize({offsetX:e,offsetY:r})),i.drawSelectedCell(i.selectedCell,i.ctx,s),i.updateScroller()}),p()(this,"onWheel",function(t){t.preventDefault?t.preventDefault:t.returnValue=!1;var e=i.opts,r=e.canvasHeight,s=e.scroll,n=e.scrollXSize,o=i.rows,l=o[o.length-1];if(l.y+l.height<r)return!1;window.requestAnimationFrame(function(){var e=i.opts.canvasHeight,r=l.y+l.height-e;s&&(r+=n),i.scrollY-=t.wheelDelta,i.scrollY=Math.min(Math.max(0,i.scrollY),r),i.render(i.scrollY,i.scrollX)})}),p()(this,"onKeydown",function(t){t.preventDefault();var e=t.keyCode;C[e]&&i.selectedCell&&i.updateSelectWithKeyboard(C[e])}),p()(this,"onMouseMove",function(t){var e=i.opts.scroll;window.requestAnimationFrame(function(){if(e){var r=t.offsetX,s=t.offsetY,n=i.realSize([r,s]);if(i.dragScrolling){if(i.hoverScrollerY){var o=i.cacheScrollerYOffset+n[1]-i.cacheMouseDownOffset[1];i.scrollY=o/(i.viewHeight-100)*(i.maxHeight-i.viewHeight),i.scrollY=Math.max(0,Math.min(i.scrollY,i.maxHeight-i.viewHeight))}if(i.hoverScrollerX){var l=i.cacheScrollerXOffset+n[0]-i.cacheMouseDownOffset[0];i.scrollX=l/(i.viewWidth-100)*(i.maxWidth-i.viewWidth),i.scrollX=Math.max(0,Math.min(i.scrollX,i.maxWidth-i.viewWidth))}return i.render(i.scrollY,i.scrollX),!1}var h={from:[i.viewWidth,i.yOffset],to:[i.width-i.xOffset,i.viewHeight-i.yOffset]},a={from:[i.xOffset,i.viewHeight],to:[i.viewWidth-i.xOffset,i.height-i.yOffset]},c=b(n,h),f=b(n,a);c?(i.emitter.emit("SCROLLER_HOVER",{type:"y",offset:n}),i.hoverScrollerY=!0):f?(i.emitter.emit("SCROLLER_HOVER",{type:"x",offset:n}),i.hoverScrollerX=!0):(i.hoverScrollerY||i.hoverScrollerX)&&(i.emitter.emit("SCROLLER_HOVER_OFF"),i.hoverScrollerY=!1,i.hoverScrollerX=!1)}})}),p()(this,"onMouseLeave",function(t){(i.hoverScrollerY||i.hoverScrollerX)&&(i.emitter.emit("SCROLLER_HOVER_OFF"),i.hoverScroller=!1,i.dragScrolling=!1)}),p()(this,"onMouseDown",function(t){(i.hoverScrollerY||i.hoverScrollerX)&&(i.dragScrolling=!0,i.cacheMouseDownOffset=i.realSize([t.offsetX,t.offsetY]),i.cacheScrollerYOffset=i.scrollerY.offset,i.cacheScrollerXOffset=i.scrollerX.offset)}),p()(this,"onMouseUp",function(t){i.dragScrolling=!1}),p()(this,"realSize",function(t){if("number"==typeof t)return t*i.pixelRatio;if(Array.isArray(t))return t.map(function(t){return t*i.pixelRatio});if(Object.prototype.toString.call(t).indexOf("Object")){for(var e in t)t[e]*=i.pixelRatio;return t}}),this.isIE=m,this.opts=this.initOpts(e),this.initGlobalVars(),this.handleCoord(),this.init(),this.listen()}return d()(t,[{key:"initOpts",value:function(t){var e=a()({},g,t);return this.pixelRatio=window.devicePixelRatio,(e=a()({},e,this.realSize({canvasWidth:e.width,canvasHeight:e.height,fontSize:e.fontSize,bitWidth:e.bitWidth,lineWidth:1}))).scroll&&(e=a()({},e,this.realSize({scrollXSize:e.scrollXSize,scrollYSize:e.scrollYSize}))),e}},{key:"initGlobalVars",value:function(){this.$target=null,this.$canvasEl=null,this.ctx=null,this.xOffset=this.realSize(.5),this.yOffset=this.realSize(.5);var t=this.opts,e=t.canvasWidth,i=t.canvasHeight,r=t.scroll,s=t.scrollYSize,n=t.scrollXSize,o=t.renderRowCount,l=t.renderColCount;this.width=e,this.height=i,this.viewWidth=r?this.width-s:this.width,this.viewHeight=r?this.height-n:this.height,this.lt=[this.xOffset,this.yOffset],this.rt=[this.width-this.xOffset,this.yOffset],this.rb=[this.width-this.xOffset,this.height-this.yOffset],this.lb=[this.xOffset,this.height-this.yOffset],this.wrapperLines=[{from:this.lt,to:this.rt},{from:this.rt,to:this.rb},{from:this.rb,to:this.lb},{from:this.lb,to:this.lt}],this.rows=null,this.columns=null,this.renderRows=null,this.renderCols=null,this.selectedCell=null,this.selectedRow=null,this.selectedCol=null,this.renderRowCount=o,this.renderColCount=l,this.scrollX=0,this.scrollY=0,this.scrollTopRowIndex=0,this.scrollTopColIndex=0,this.emitter=L()}},{key:"handleCoord",value:function(){var t=this,e=this.opts,i=e.rows,r=e.columns,s=e.bitWidth,n=this.yOffset,o=this.xOffset,l=!1,h=!1;i=i.map(function(e,i){n>=t.viewHeight&&!l&&(l=!0,t.renderRowCount=i+1);var r=e.height;return r=y(t.realSize(r)),e=a()({},e,{y:n,height:r,index:i}),n+=r,e}),r=r.map(function(e,i){o>=t.viewWidth&&!h&&(h=!0,t.renderColCount=i+1);var r=e,n=r.width,l=r.type,c=r.bits;n=y(t.realSize(n));var f=o;if("money"===l){var u=[];n=y(s*c+2*t.realSize(2));for(var d=0;d<c;d++)u.push(f+d*t.realSize(s));e.bitsX=u}return e=a()({},e,{x:f,width:n,index:i}),o+=n,e}),this.rows=i,this.columns=r}},{key:"init",value:function(){if(this.createCanvas(this.opts),this.render(this.scrollY,this.scrollX),this.opts.scroll){var t=this.rows[this.rows.length-1],e=this.columns[this.columns.length-1];this.maxHeight=t.y+t.height,this.maxWidth=e.x+e.width,this.initScroller()}}},{key:"createCanvas",value:function(t){var e=t.target,i=document.querySelector(e);if(!i)throw new Error("Can't find target element, Please input [target] attribute, again.");var r=document.createElement("canvas",{alpha:!1});i.appendChild(r);var s=t.width,n=t.height,o=t.fontSize,l=t.fontFamily,h=t.fontWeight,a=t.fillColor,c=t.strokeColor;this.$canvasEl=r,this.ctx=r.getContext("2d"),this.setCanvasElAttrs({class:t.className,style:"width:".concat(s,"px; height:").concat(n,"px;"),width:this.width,height:this.height,tabindex:"-1"},this.$canvasEl),E({font:"".concat(h," ").concat(o,"px ").concat(l),fillStyle:a,strokeStyle:c,textBaseline:"middle",textAlign:"center"},this.ctx)}},{key:"render",value:function(){this.updateScrollTopIndex(),this.updateFilters(),this.updateLines(),this.updateCustomStyle(),this.ctx.clearRect(0,0,this.viewWidth,this.viewHeight),this.drawBg(),this.drawLines(this.colLines,this.rowLines),this.drawTexts(this.renderCols,this.renderRows,this.ctx),this.drawMergeCell(this.renderMerges,this.ctx),this.drawSelectedCell(this.selectedCell,this.ctx),this.updateScroller(),this.drawWrapper()}},{key:"updateScrollTopIndex",value:function(){this.scrollTopRowIndex=this.getScrollTopRowIndex(this.scrollY,this.scrollTopRowIndex,this.rows),this.scrollTopColIndex=this.getScrollTopColIndex(this.scrollX,this.scrollTopColIndex,this.columns)}},{key:"updateFilters",value:function(){var t=this.filterData(this.opts),e=t.renderCols,i=t.renderRows,r=t.renderMerges;this.renderCols=e,this.renderRows=i,this.renderMerges=r}},{key:"updateLines",value:function(){var t=this.getColLines(this.renderCols,this.viewHeight),e=this.getRowLines(this.renderRows,this.viewWidth);this.colLines=t,this.rowLines=e}},{key:"updateCustomStyle",value:function(){var t=this.opts,e=t.setColStyle,i=t.setRowStyle;t.setCellStyle;if(e){var r=e(this.renderCols);this.colStyles=this.handleColStyle(r)}if(i){var s=i(this.renderRows);this.rowStyles=this.handleRowStyle(s)}}},{key:"handleColStyle",value:function(t){var e=this,i=[];return t.forEach(function(t){var r=t.index,s=t.styles,n=e.renderCols[r],o=n.x,l=n.width;i.push({rect:[o-e.scrollX,e.yOffset,l,e.viewHeight],styles:s})}),i}},{key:"handleRowStyle",value:function(t){var e=this,i=[];return t.forEach(function(t){var r=t.index,s=t.styles,n=e.renderRows[r],o=n.y,l=n.height;i.push({rect:[e.xOffset,o-e.scrollY,e.viewWidth,l],styles:s})}),i}},{key:"drawBg",value:function(){var t=this;this.colStyles.forEach(function(e){var i;t.ctx.save();var r=e.rect,s=e.styles;E(s,t.ctx),(i=t.ctx).fillRect.apply(i,l()(r)),t.ctx.restore()}),this.rowStyles.forEach(function(e){var i;t.ctx.save();var r=e.rect,s=e.styles;E(s,t.ctx),(i=t.ctx).fillRect.apply(i,l()(r)),t.ctx.restore()})}},{key:"drawLines",value:function(){var t;R({lines:(t=[]).concat.apply(t,arguments),ctx:this.ctx})}},{key:"drawTexts",value:function(t,e,i){var r=this.getValueInfos(t,e,i);O(r,i)}},{key:"drawWrapper",value:function(){R({lines:this.wrapperLines,ctx:this.ctx})}},{key:"initScroller",value:function(){var t=this.opts,e=t.scrollXSize,i=t.scrollYSize,r=n()(this.rt,2),s=r[0],o=r[1],l=n()(this.lb,2),h=l[0],a=l[1];this.scrollerY=new I({emitter:this.emitter,ctx:this.ctx,type:"y",width:i,height:this.viewHeight+e-this.realSize(2),barWidth:30,barHeight:100,x:s-i-this.xOffset,y:o+this.yOffset,maxScrollSize:this.viewHeight-this.xOffset}),this.scrollerX=new I({emitter:this.emitter,ctx:this.ctx,type:"x",width:this.viewWidth+i-this.realSize(2),height:e,barWidth:100,barHeight:30,x:h+this.xOffset,y:a-e-this.yOffset,maxScrollSize:this.viewWidth-this.xOffset})}},{key:"updateScroller",value:function(){if(!this.opts.scroll)return!1;this.scrollerX&&this.scrollerY&&(this.scrollerX.scrollTo(this.scrollX/(this.maxWidth-this.viewWidth)*(this.viewWidth-100)),this.scrollerY.scrollTo(this.scrollY/(this.maxHeight-this.viewHeight)*(this.viewHeight-100)))}},{key:"filterData",value:function(t){for(var e=t.merges,i=this.columns,r=this.rows,s=[],n=[],o=[],l=this.scrollTopColIndex;l<this.renderColCount+this.scrollTopColIndex;l++){var h=i[l];if(!h)break;h&&s.push(h)}for(var a=this.scrollTopRowIndex;a<this.renderRowCount+this.scrollTopRowIndex;a++){if(!r[a])break;n.push(r[a])}if(e)for(var c=0;c<e.length;c++){var f=e[c],u=f.from,d=f.to;u[0]<=s[s.length-1].index&&u[1]<=n[n.length-1].index&&d[0]<this.columns.length&&d[1]<this.rows.length&&o.push(f)}return{renderCols:s,renderRows:n,renderMerges:o}}},{key:"getColLines",value:function(t,e){var i=this,r=[];return t.forEach(function(t){var s=t.x,n=t.width,o=t.type,l=[s+n-i.scrollX,i.yOffset];if("money"===o){var h=i.getMoneyColLines(t,e),a=h.bitLines;h.bitColorLines;r=[].concat(r,a)}var c=[s+n-i.scrollX,e-i.yOffset];r.push({from:l,to:c})}),r}},{key:"getMoneyColLines",value:function(t,e){for(var i=t.bits,r=t.x,s=this.opts.bitWidth,n=[],o=r+this.realSize(2),l=i;l>=0;l--)n.push({from:[o-this.scrollX,this.yOffset],to:[o-this.scrollX,e-this.yOffset]}),o+=s;return{bitLines:n,bitColorLines:[]}}},{key:"getRowLines",value:function(t,e){var i=this,r=[];return t.forEach(function(t){var s=t.y,n=t.height,o=[0,s+n-i.scrollY],l=[e-i.xOffset,s+n-i.scrollY];r.push({from:o,to:l})}),r}},{key:"setCanvasElAttrs",value:function(t,e){for(var i in t)e.setAttribute(i,t[i])}},{key:"drawRect",value:function(t,e,i){var r=this;if(!t||!t.length)return!1;i&&(e.save(),E(i,e)),t.forEach(function(t){if(!t)return!1;var i=t.x,s=t.y,n=t.width,o=t.height;i-=r.scrollX,s-=r.scrollY,e.fillRect(i,s,n,o)}),i&&e.restore()}},{key:"getValueInfos",value:function(t,e,i){var r=this,s=[],n=this.opts.bitWidth;return t.forEach(function(t){var o=t.id,l=t.x,h=t.width,c=t.type;e.forEach(function(t){var e=t.data,f=t.y,u=t.height,d=e[o]+"",v=l-r.scrollX,p=f-r.scrollY;if("money"===c)for(var g={y:y(p+u/2)},w=d.split(""),m=0,b=w.length-1;b>0;b--){var C=w[b],R=v+h-r.realSize(2)-m*n;g=a()({},g,{x:R-n/2,value:C}),s.push(g),m++}else{var O=i.measureText(d).width;O>h&&(d=S(d,O,h)),s.push(x(d,{x:v,y:p,width:h,height:u}))}})}),s}},{key:"listen",value:function(){this.$canvasEl.addEventListener("click",this.onClick),this.isIE?this.$canvasEl.addEventListener("mousewheel",this.onWheel):this.$canvasEl.addEventListener("wheel",this.onWheel),this.$canvasEl.addEventListener("keydown",this.onKeydown),this.$canvasEl.addEventListener("mousemove",this.onMouseMove),this.$canvasEl.addEventListener("mouseleave",this.onMouseLeave),this.$canvasEl.addEventListener("mousedown",this.onMouseDown),this.$canvasEl.addEventListener("mouseup",this.onMouseUp)}},{key:"updateSelect",value:function(t){var e=this.renderCols,i=this.renderRows,r=t.offsetX,s=t.offsetY;for(var n in this.renderMerges){var o=this.renderMerges[n],l=o.from,h=o.to,a=this.columns[l[0]],c=this.rows[l[1]],f=this.columns[h[0]],u=this.rows[h[1]],d=a.x,v=c.y,p=f.x+f.width,g=u.y+u.height;if(b([r+this.scrollX,s+this.scrollY],{from:[d,v],to:[p,g]}))return this.selectedCell={x:d,y:v,width:p-d,height:g-v,value:c.data[a.id],isMerge:!0,startRowIndex:c.index,startColIndex:a.index,startRowId:c.id,startColId:a.id,endRowIndex:u.index,endColIndex:f.index,endRowId:u.id,endColId:f.id},!1}this.selectedCol=w(e,r+this.scrollX,"x"),this.selectedRow=w(i,s+this.scrollY,"y");var y=this.selectedCol,x=y.x,m=y.width,S=y.id,C=y.index,R=y.type,O=y.bitsX,k=this.selectedRow,E=k.y,X=k.height,I=k.id,L=k.index,Y=k.data;this.selectedCell={x:x,y:E,width:m,height:X,value:Y[S],rowIndex:L,rowId:I,colIndex:C,colId:S,type:R,bitsX:O}}},{key:"updateSelectWithKeyboard",value:function(t){var e,i=this.selectedCell,r=this.scrollX,s=this.scrollY,n=i.isMerge,o=i.startRowIndex,l=i.endRowIndex,h=i.rowIndex,a=i.startColIndex,c=i.endColIndex,f=i.colIndex,u=this.opts,d=u.canvasHeight,v=u.canvasWidth,p=u.scroll,g=u.scrollXSize,y=u.scrollYSize,w=0,x=0;switch(t){case"ARROW_LEFT":x=n?o:h,w=n?a-1:f-1;break;case"ARROW_RIGHT":x=n?o:h,w=n?c+1:f+1;break;case"ARROW_UP":x=n?o-1:h-1,w=n?a:f;break;case"ARROW_DOWN":x=n?l+1:h+1,w=n?a:f}w=Math.max(0,Math.min(this.columns.length-1,w)),x=Math.max(0,Math.min(this.rows.length-1,x));var m=this.rows[x],S=this.columns[w];e={offsetX:Math.max(1,S.x-r+1),offsetY:Math.max(1,m.y-s+1)},this.updateSelect(e);var b=this.selectedCell,C=b.x,R=b.y,O=b.width,k=b.height;if(R+k-s>=d){this.scrollY=R;var E=this.rows[this.rows.length-1],X=E.y+E.height-d;p&&(X+=g),this.scrollY=Math.min(this.scrollY,X)}if(R<=s&&(this.scrollY-=d-(k-(s-R)),this.scrollY=Math.max(0,this.scrollY)),C+O-r>=v){this.scrollX=C;var I=this.columns[this.columns.length-1],L=I.x+I.width-v;p&&(L+=y),this.scrollX=Math.min(this.scrollX,L)}C<=r&&(this.scrollX-=v-(O-(r-C)),this.scrollX=Math.max(0,this.scrollX)),this.render(this.scrollY,this.scrollX)}},{key:"drawSelectedCell",value:function(t,e,i){if(i){var r=i.value,s=i.x,n=void 0===s?n:s,o=i.y,l=i.width,h=i.height;i.type;if(t.x===n&&t.y===o)return!1;if(this.scrollY<=o&&this.scrollX<=n){var a={x:n+this.xOffset-this.scrollX,y:o+this.yOffset-this.scrollY,width:l-this.xOffset,height:h-this.yOffset};k([a],this.ctx);var c=e.measureText(r).width;c>l&&(r=S(r,c,l)),O([x(r,a)],e),R({lines:[].concat(this.getRectLines(i),this.wrapperLines),ctx:e})}}this.drawRect([t],e,{fillStyle:"rgba(0,0,200, .2)"}),R({lines:this.getRectLines(t),ctx:e,styles:{strokeStyle:"#0000ff"}})}},{key:"drawMergeCell",value:function(t,e){var i=this,r=[],s=[],o=[];t.forEach(function(t,l){var h=t.from,a=t.to,c=n()(h,2),f=c[0],u=c[1],d=n()(a,2),v=d[0],p=d[1],g=i.columns[f],y=i.rows[u],w=i.columns[v],m=i.rows[p],b=g.x,C=y.y,R=w.x+w.width-g.x,O=m.y+m.height-y.y;o.push({x:b-i.scrollX,y:C-i.scrollY,width:R,height:O});var k=i.getRectLines({x:b,y:C,width:R,height:O});r=[].concat(r,k);var E=y.data[g.id],X=e.measureText(E).width;X>R&&(E=S(E,X,R));var I=x(E,{x:b-i.scrollX,y:C-i.scrollY,width:R,height:O});s.push(I)}),k(o,e),R({lines:r,ctx:e}),O(s,e)}},{key:"getRectLines",value:function(t){if(!t)return!1;var e=t.x,i=t.y,r=t.width,s=t.height;return[{from:[e-=this.scrollX,i-=this.scrollY],to:[e+r,i]},{from:[e+r,i],to:[e+r,i+s]},{from:[e+r,i+s],to:[e,i+s]},{from:[e,i+s],to:[e,i]}]}},{key:"getScrollTopRowIndex",value:function(t,e,i){if(t<=0)return 0;var r=i[e],s=r.y;if(t>r.height+s)for(var n=e;n<i.length;n++){var o=i[n];if(o.y+o.height>t)return n}if(t<s)for(var l=e;l>=0;l--){if(t>i[l].y)return l}return e}},{key:"getScrollTopColIndex",value:function(t,e,i){if(t<=0)return 0;var r=i[e],s=r.x;if(t>r.width+s)for(var n=e;n<i.length;n++){var o=i[n];if(o.x+o.width>t)return n}if(t<s)for(var l=e;l>=0;l--){if(t>i[l].x)return l}return e}}]),t}(),M=function(){return this.opts.rows},W=function(){return this.opts.columns},T=function(t){return this.opts.rows[t]},A=function(t){return this.opts.columns[t]},H=function(){return this.selectedCell};for(var z in Y.prototype.getVersion=function(){return"v0.0.1"},r)Y.prototype[z]=r[z];window.CanvasForm=Y;e.default=Y}]);